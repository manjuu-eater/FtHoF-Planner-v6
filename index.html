<!DOCTYPE html>
<html lang="en-US" xmlns="http://www.w3.org/1999/html">
<head>
    <!-- Angular Material requires Angular.js Libraries -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-animate.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-aria.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-messages.min.js"></script>
    <!-- Angular Material Library -->
    <script src="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.8/angular-material.min.js"></script>

    <script src="./lib/seedrandom.min.js"></script>
    <script src="./lib/base64.js"></script>
    <script type="module" src="index.js"></script>

    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.ico?">
    <link rel="stylesheet" type="text/css" href="index.css">
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.8/angular-material.min.css">


    <title>FtHoF Planner v6</title>
</head>
<body>
<md-toolbar>
    <div class="md-toolbar-tools">
        <h1>
            <span>Cookie Clicker FtHoF Planner v6</span>
        </h1>
    </div>
</md-toolbar>
<div ng-app="myApp" ng-controller="myCtrl">
    <div class="content">
        <div layout="row">
            <md-input-container flex>
                <label>Save Code</label>
                <input onClick="this.select();" ng-model="save_string" style="color: grey;">
            </md-input-container>
            <md-button class="md-raised md-primary" ng-click="load_game()">Import Save</md-button>
        </div>

        <p><b>
            Based on FtHoF planner v1, v2, v3, v4, v5 by RebelKeithy, Skeezy, Eminenti, Mylaaan and Joseph3079.
            Huge thanks to them for creating such a helpful tool.<br>
            ◆ <a href="./version_history.html">full version history, credits & contacts</a>
        </b></p>
        <p><b>
            The current version is compatible with cookie clicker 2.052, "often imitated, never duplicated".
        </b></p>

        <p>
            RebelKeithy, Skeezy, Mylaaan, & Joseph3079 made a guide explaining the options/features we added.<br>
            <b>◆ <a href="./user_guide.html">User Guide</a></b>
        </p>

        <md-divider></md-divider>

        <ul ng-if="combos">
            <li class="combo-listitem" ng-repeat="combo in combos">
                <b>{{$index + min_combo_length}}x Combo</b>
                <ul ng-if="combo.shortest.idx == -1">
                    <li>No combo of this length</li>
                </ul>
                <ul ng-if="combo.shortest.idx != -1">
                    <li ng-if="combo.first.idx != -1">
                        <a href="#{{combo.first.idx + 1}}">Earliest:</a>
                        Length {{combo.first.length}};
                        spread {{combo.first.length - ($index + min_combo_length)}};
                        starting at
                        <a href="#{{combo.first.idx + 1}}">spell #{{combo.first.idx+1}}</a>
                    </li>
                    <li ng-if="combo.first.idx == -1">
                        No combo of this length with spread &lt;= {{max_spread}}
                    </li>
                    <li>
                        <a href="#{{combo.shortest.idx + 1}}">Shortest:</a>
                        Length {{combo.shortest.length}};
                        spread {{combo.shortest.length - ($index + min_combo_length)}};
                        starting at
                        <a href="#{{combo.shortest.idx + 1}}">spell #{{combo.shortest.idx+1}}</a>
                    </li>
                </ul>
            </li>
        </ul>

        <md-divider></md-divider>

        <label>Lookahead length</label>
        <input type="number" ng-model="lookahead" min=10 max=1000>

        <md-divider></md-divider>

        <label>Min Combo</label>
        <input type="number" ng-model="min_combo_length" min=1 max=20>

        <label>Max Combo</label>
        <input type="number" ng-model="max_combo_length" min=1 max=20>

        <label>Max Spread</label>
        <input type="number" ng-model="max_spread" min=0 max=99>

        <md-checkbox ng-checked=true ng-model="include_ef_in_sequence" aria-label="Include Elder Frenzy">
            Include Elder Frenzies
        </md-checkbox>

        <md-checkbox ng-checked=true ng-model="skip_abominations" aria-label="Allow Abomination Skips">
            Skip Abominations
        </md-checkbox>

        <md-checkbox ng-checked=true ng-model="skip_edifices" aria-label="Allow Spontaneous Edifice Skips">
            Skip Spontaneous Edifices
        </md-checkbox>


        <md-divider></md-divider>

        <label>Golden Cookies on screen</label>
        <input type="number" ng-model="on_screen_cookies" min=0 max=10>

        <md-checkbox ng-model="dragonflight" aria-label="Dragonflight Buff Active">
            Dragonflight Buff Active
        </md-checkbox>

        <md-checkbox ng-model="supremeintellect" aria-label="Supreme Intellect Aura Active">
            Supreme Intellect Aura Active
        </md-checkbox>

        <md-checkbox ng-model="diminishineptitude" aria-label="Diminish Ineptitude Active">
            Diminish Ineptitude Active
        </md-checkbox>


        <md-divider></md-divider>

        <md-button class="md-raised md-primary" ng-click="update_cookies()">Apply Settings</md-button>
        <md-button class="md-raised md-primary" ng-click="cast_spell()">Cast Spell</md-button>
        <md-button class="md-raised md-primary" ng-click="cast_spell(5)">x5</md-button>
        <md-button class="md-raised md-primary" ng-click="cast_spell(10)">x10</md-button>
        <!-- <md-button class="md-raised md-primary" ng-click="print_scope()">Print Scope</md-button> -->

        <md-divider></md-divider>

        <table>
            <thead>
                <tr>
                    <th>Spell #</th>
                    <th>Random Seed</th>
                    <th>No Change</th>
                    <th>One Change</th>
                    <th>Gambler's Dream</th>
                </tr>
                <tr>
                    <td>Relative to now (This ascension | All time)</td>
                    <td>Used to determine spell backfires and GFD spells.</td>
                    <td>Season is not Easter or Valentines.</td>
                    <td>Season is Easter or Valentines.</td>
                    <td>Gambler's Fever Dream</td>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="cookie_list in cookies">
                    <!-- Spell # -->
                    <td><div>
                        <a name="{{$index + 1}}"></a>
                        {{
                            ($index + 1)
                            + " (" + (spellsCastThisAscension+$index+1)
                            + " | " + (spellsCastTotal+$index+1)
                            + ")"
                        }}
                    </div></td>

                    <!-- Random Seed -->
                    <td><div>
                        {{
                            randomSeeds[$index].toFixed(4)
                            + " ("
                            + (
                                randomSeeds[$index] + baseBackfireChance > 1
                                ? 0
                                : ((1.075-randomSeeds[$index] - baseBackfireChance) / 0.15).toFixed(0)
                            )
                            + " GC)"
                        }}
                    </div></td>

                    <!-- No Change -->
                    <td><div>
                        <img ng-src="{{displayCookies[$index][0].wrath ? 'img/WrathCookie.png' : 'img/GoldCookie.png'}}">
                        <div class="{{displayCookies[$index][0].noteworthy ? 'highlightCombo' : ''}}">
                            {{displayCookies[$index][0].type}}
                        </div>
                    </div></td>

                    <!-- One Change -->
                    <td><div>
                        <img ng-src="{{displayCookies[$index][1].wrath ? 'img/WrathCookie.png' : 'img/GoldCookie.png'}}">
                        <div class="{{displayCookies[$index][1].noteworthy ? 'highlightCombo' : ''}}">
                            {{displayCookies[$index][1].type}}
                        </div>
                    </div></td>

                    <!-- Gambler's Dream -->
                    <td><div>
                        <img ng-src="{{displayCookies[$index][2].backfire? ' img/WrathCookie.png' : 'img/GoldCookie.png'}}">
                        <div class="{{
                            (displayCookies[$index][2].hasBs || displayCookies[$index][2].hasEf)
                                ? 'highlightCombo'
                                : (displayCookies[$index][2].type == 'Resurrect Abomination' || (displayCookies[$index][2].type == 'Spontaneous Edifice' && !displayCookies[$index][2].backfire))
                                    ? 'highlightSkip'
                                    : '';
                        }}" title="{{displayCookies[$index][2].innerCookie1.type + '; ' + displayCookies[$index][2].innerCookie2.type}}">
                            {{displayCookies[$index][2] ? displayCookies[$index][2].type : "Blank"}}
                        </div>
                    </div></td>
                </tr>
            </tbody>
        </table>

        <md-button class="md-raised md-primary" ng-click="load_more()">Load More</md-button>
    </div>
</div>
</body>
</html>
